axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size =1, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 5, alpha = 1) +
scale_fill_viridis(discrete = TRUE, direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
a1 <- ggplot(filter(induce_combo, Min_10 == 'minus10cons', Min_35 == 'minus35_31A_32C'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Consensus -10 & Mutated -35 (31A,32C)', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
a2 <-ggplot(filter(induce_combo, Min_10 == 'minus10_12G', Min_35 == 'minus35cons'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Mutated -10 (12G) & Consensus -35', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym"))  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 1) + geom_point(aes(color = Type), size = 5, alpha = 0.5) +
scale_color_viridis(discrete = TRUE, direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
a1 <- ggplot(filter(induce_combo, Min_10 == 'minus10cons', Min_35 == 'minus35_31A_32C'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Consensus -10 & Mutated -35 (31A,32C)', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
a2 <-ggplot(filter(induce_combo, Min_10 == 'minus10_12G', Min_35 == 'minus35cons'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Mutated -10 (12G) & Consensus -35', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym"))  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 5, alpha = 0.7) +
scale_color_viridis(discrete = TRUE, direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
a1 <- ggplot(filter(induce_combo, Min_10 == 'minus10cons', Min_35 == 'minus35_31A_32C'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Consensus -10 & Mutated -35 (31A,32C)', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
a2 <-ggplot(filter(induce_combo, Min_10 == 'minus10_12G', Min_35 == 'minus35cons'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Mutated -10 (12G) & Consensus -35', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym"))  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_color_viridis(discrete = TRUE, direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
a1 <- ggplot(filter(induce_combo, Min_10 == 'minus10cons', Min_35 == 'minus35_31A_32C'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Consensus -10 & Mutated -35 (31A,32C)', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
a2 <-ggplot(filter(induce_combo, Min_10 == 'minus10_12G', Min_35 == 'minus35cons'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Mutated -10 (12G) & Consensus -35', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym"))  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_color_manual(values = c("#20d420", "#000072"), direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_color_discrete(values = c("#20d420", "#000072"), direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_color_manual(values = c("#20d420", "#000072"), direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_colour_manual(values = c("#20d420", "#000072"), direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_colour_manual(values = c("#20d420", "#000072"), name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_colour_manual(values = c("#20d420", "#000072"), name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
a1 <- ggplot(filter(induce_combo, Min_10 == 'minus10cons', Min_35 == 'minus35_31A_32C'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Consensus -10 & Mutated -35 (31A,32C)', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
a2 <-ggplot(filter(induce_combo, Min_10 == 'minus10_12G', Min_35 == 'minus35cons'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Mutated -10 (12G) & Consensus -35', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym"))  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_color_manual(discrete = TRUE, direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
# Figure S3: Pcombo supplements
A <- induce_combo %>%
filter(Distal == 'lacOsym', Min_10 == 'minus10cons', Min_35 == 'minus35cons') %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = Proximal, y = Expression)) + geom_line(color = 'black', size = 1, alpha = 0.7) + geom_point(aes(color = Type), size = 10, alpha = 0.7) +
scale_color_viridis(discrete = TRUE, direction = -1, name = 'Condition', labels = c("Induced Expression", "Uninduced Expression")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24),
legend.text = element_text(size = 20),
legend.title = element_text(size = 21))
a1 <- ggplot(filter(induce_combo, Min_10 == 'minus10cons', Min_35 == 'minus35_31A_32C'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Consensus -10 & Mutated -35 (31A,32C)', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
a2 <-ggplot(filter(induce_combo, Min_10 == 'minus10_12G', Min_35 == 'minus35cons'), aes(x = Proximal, y = Distal)) + geom_tile(aes(fill = log2(ratio)), color = 'black', alpha = 0.9, size = 0.25) +
scale_fill_viridis(name = expression('log'[2]~'(Fold-change)')) +
labs(x = 'Proximal', y = 'Distal', title = 'Mutated -10 (12G) & Consensus -35', size = 20) +
theme(panel.background = element_rect(fill = "gray40")) +
scale_x_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym")) +
scale_y_discrete(limits = c("lacOscram", "O3_leftSym", "lacO2", "O3_rightSym", "O1_rightSym", "O2_leftSym", "lacO3", "O2_rightSym", "lacO1", "lacOsym"))  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 20),
axis.text.y = element_text(size = 20),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
B <- plot_grid(a1, a2)
rm(a1,a2)
plot_grid(A,B, labels='AUTO', ncol = 1)
ggsave('../FigureSX/FigureS3.pdf', height = 12, width = 16)
knitr::opts_knit$set(root.dir = getwd())
library("ggplot2")
library(tidyverse)
library("wesanderson")
names(wes_palettes)
require(cowplot)
pal <- wes_palette('Zissou1', 6, type = 'continuous')
options(stringsAsFactors = F)
loop_MOPS <- read.table("../processed_data/fLP3.loop_MOPS_glu_expression.txt", header = T)
loop_MOPS$name <- gsub("offset", "", loop_MOPS$name)
loop_MOPS$name <- gsub("_cap", "", loop_MOPS$name)
loop_MOPS$name <- gsub("lac_bg", "lac", loop_MOPS$name)
loop_vars <- loop_MOPS %>% separate(col = 'name', into = c("TF", "Distal", "Offset", "Background", 'Proximal') , sep = "_", remove = F)
loop_vars <- loop_vars[!is.na(loop_vars$Proximal),]
loop_vars$Offset <- as.numeric(loop_vars$Offset)
TF_spacing <- filter(loop_vars, Background == 'ind')
median_barcodes <- median(TF_spacing$num_barcodes)
ggplot(TF_spacing, aes(x=num_barcodes)) +
geom_histogram(color = 'black') +
scale_x_log10() +
labs(x = "Number of barcodes",
y = 'Counts') +
annotation_logticks(sides = 'b') +
geom_vline(xintercept = median_barcodes, color = 'red', linetype = 'dashed') +
annotate('text', x = 10, y = 90, label = paste("Median =", median_barcodes, "barcodes"), size = 8) +
theme(axis.text.x = element_text(size = 24),
axis.text.y = element_text(size = 24),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
ggsave('../FigureSX/FigureS1.pdf', units = 'in', width = 7.29, height = 4.51)
theme_set(theme_cowplot())
median_barcodes <- median(TF_spacing$num_barcodes)
ggplot(TF_spacing, aes(x=num_barcodes)) +
geom_histogram(color = 'black') +
scale_x_log10() +
labs(x = "Number of barcodes",
y = 'Counts') +
annotation_logticks(sides = 'b') +
geom_vline(xintercept = median_barcodes, color = 'red', linetype = 'dashed') +
annotate('text', x = 10, y = 90, label = paste("Median =", median_barcodes, "barcodes"), size = 8) +
theme(axis.text.x = element_text(size = 24),
axis.text.y = element_text(size = 24),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
ggsave('../FigureSX/FigureS1.pdf', units = 'in', width = 7.29, height = 4.51)
#What percent of variants were tested?
full_library <- read.table("../ref/looping_lib_v2_controls_clean.txt", col.names = c('name', 'sequence'))
knitr::opts_knit$set(root.dir = getwd())
library("ggplot2")
library(tidyverse)
library("wesanderson")
names(wes_palettes)
require(cowplot)
pal <- wes_palette('Zissou1', 6, type = 'continuous')
options(stringsAsFactors = F)
# What percent of variants were tested?
full_library <- read.table("../raw_data/looping_architectures/looping_lib_v2_controls_clean.txt", col.names = c('name', 'sequence'))
full_library$name <- gsub("offset", "", full_library$name)
full_library$name <- gsub("_cap", "", full_library$name)
full_library$name <- gsub("lac_bg", "lac", full_library$name)
full_library <- subset(full_library, grepl("ind", full_library$name))
temp <- subset(full_library, !grepl("control", full_library$name)) %>% anti_join(., TF_spacing, by = 'name')
subset(loop_vars, !grepl("apFAB", loop_vars$name))
head(TF_spacing$name)
paste(signif(100*nrow(TF_spacing)/nrow(full_library),3), "%", sep = '')
#What percent of variants were tested?
full_library <- read.table("../raw_data/looping_architectures/looping_lib_v2_controls_clean.txt", col.names = c('name', 'sequence'))
full_library$name <- gsub("offset", "", full_library$name)
full_library$name <- gsub("_cap", "", full_library$name)
full_library$name <- gsub("lac_bg", "lac", full_library$name)
full_library <- subset(full_library, grepl("ind", full_library$name))
temp <- subset(full_library, !grepl("control", full_library$name)) %>% anti_join(., TF_spacing, by = 'name')
subset(loop_vars, !grepl("apFAB", loop_vars$name))
head(TF_spacing$name)
paste(signif(100*nrow(TF_spacing)/nrow(full_library),3), "%", sep = '')
neg <- subset(loop_MOPS, grepl("neg_control", loop_MOPS$name))
pos <- subset(loop_MOPS, grepl("pos_control", loop_MOPS$name))
temp <-subset(loop_MOPS, grepl("_ind_", loop_MOPS$name)) %>%
subset(!grepl('apFAB',.$name))
cor <- cor(temp$RNA_exp_1, temp$RNA_exp_2)
subset(loop_MOPS, grepl("_ind_", loop_MOPS$name)) %>%
subset(!grepl('apFAB',.$name)) %>%
ggplot(., aes(RNA_exp_1, RNA_exp_2)) +
geom_point(alpha = .6) +
scale_x_log10() + scale_y_log10() + annotation_logticks(sides = 'bl') +
annotate("text", label = paste("italic(r)==", signif(cor, 3)), parse = TRUE,
x = 0.2, y = 1, size = 8) +
xlab('Technical Replicate #1\n(RNA/DNA)') + ylab('Technical Replicate #2\n(RNA/DNA)') +
ggtitle('Correlation between replicate TSS measurements') +
geom_point(data = neg,aes(RNA_exp_1, RNA_exp_2), color = "firebrick1", alpha = .6) +
geom_point(data = pos,aes(RNA_exp_1, RNA_exp_2), color = "dodgerblue1", alpha = .6) +
annotate("text", label = "Negative Controls", x = 3, y = .1, color = 'firebrick1', size = 8) +
annotate("text", label = "Positive Controls", x = 3, y = .2, color = 'dodgerblue1', size = 8) +
theme(axis.text.x = element_text(size = 24),
axis.text.y = element_text(size = 24),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
ggsave('../Figure1/Figure1C.pdf', units = 'in',  width = 6, height = 6)
neg <- subset(loop_MOPS, grepl("neg_control", loop_MOPS$name))
pos <- subset(loop_MOPS, grepl("pos_control", loop_MOPS$name))
temp <-subset(loop_MOPS, grepl("_ind_", loop_MOPS$name)) %>%
subset(!grepl('apFAB',.$name))
cor <- cor(temp$RNA_exp_1, temp$RNA_exp_2)
subset(loop_MOPS, grepl("_ind_", loop_MOPS$name)) %>%
subset(!grepl('apFAB',.$name)) %>%
ggplot(., aes(RNA_exp_1, RNA_exp_2)) +
geom_point(alpha = .6) +
scale_x_log10() + scale_y_log10() + annotation_logticks(sides = 'bl') +
annotate("text", label = paste("italic(r)==", signif(cor, 3)), parse = TRUE,
x = 0.2, y = 1, size = 8) +
xlab('Technical Replicate #1\n(RNA/DNA)') + ylab('Technical Replicate #2\n(RNA/DNA)') +
ggtitle('Correlation between replicate TSS measurements') +
geom_point(data = neg,aes(RNA_exp_1, RNA_exp_2), color = "firebrick1", alpha = .6) +
geom_point(data = pos,aes(RNA_exp_1, RNA_exp_2), color = "dodgerblue1", alpha = .6) +
annotate("text", label = "Negative Controls", x = 3, y = .1, color = 'firebrick1', size = 8) +
annotate("text", label = "Positive Controls", x = 3, y = .2, color = 'dodgerblue1', size = 8) +
theme(axis.text.x = element_text(size = 24),
axis.text.y = element_text(size = 24),
axis.title.x.bottom = element_text(size = 24),
axis.title.y.left = element_text(size = 24))
ggsave('../Figure1/Figure1D.pdf', units = 'in',  width = 6, height = 6)
#STATISTICAL TEST PERFORMED AT END OF other script, barcodeQuant_LacZSpacing.Rmd
mean_proximal <- TF_spacing %>% filter(Proximal == 'proximal' & Background == 'ind', Distal == 'nodistal') %>%
group_by(TF) %>%
mutate(mean_expression_proximal = mean(RNA_exp_12)) %>%
ungroup() %>%
select(TF, mean_expression_proximal) %>% distinct()
#Nullproximal site was generated by scrambling LacI
mean_noproximal <- TF_spacing %>% filter(Proximal == 'nullproximal' & Background == 'ind', Distal == 'nodistal') %>%
group_by(TF) %>%
mutate(mean_expression_noproximal = mean(RNA_exp_12)) %>%
ungroup() %>%
select(TF, mean_expression_noproximal) %>% distinct()
znull <-as.data.frame(cbind(c(as.numeric(1)), c("znull"))) %>% mutate(V1 = as.numeric(V1))
names(znull) <- c('relative_repression', 'TF')
test<- data.frame() %>% mutate(TF='znull', relative_repression = 1)
b <- left_join(mean_proximal, mean_noproximal, by = 'TF') %>%
mutate(relative_repression = mean_expression_proximal/mean_expression_noproximal) %>%
select(TF, relative_repression) %>% rbind(znull) %>%
ggplot(., aes(x= TF, y = relative_repression, fill = TF)) +
geom_bar(stat = 'identity', position = 'dodge', width = .65) +
scale_fill_manual(values = c(pal, 'gray60')) +
scale_x_discrete(expand = c(0,2)) +
geom_hline(yintercept = 1, linetype = 'dashed', color = 'gray') +
labs(x = 'Transcription Factor', y = 'Relative expression', Title = 'Effect of Repressor at Proximal Site') +
theme(axis.text.x = element_text(size = 20, angle = 45, hjust = 1),
axis.title.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.text=element_text(size=20),
legend.position = 'none')
b
#The top part of figure 1d is produced in the barcodeQuant_LacZSpacing.Rmd script
ggsave('../Figure1/Figure1E.pdf', units = 'in', width = 12, height = 4)
#Here we add a 3bp windown centered around 115.5, a repression optima determined by Johannes Muller et al. 1996
in_phase=data.frame(x1=c(102.5,114,125), x2=c(105.5,117,128), y1=c(.75,.75,.75), y2=c(1.35,1.35,1.35))
TF_spacing %>% filter(., Proximal == 'nullproximal', Distal == 'distal') %>%
left_join(., mean_noproximal, by = 'TF') %>%
mutate(relative_distal = RNA_exp_12/mean_expression_noproximal,
spacing=Offset+94) %>% #interoperator distance calculated by: promoter is 71 bp + 23bp TF site + offset
mutate(spacing = ifelse(TF=='GalR', spacing+1, spacing), #adjust to center of operator binding sites
spacing = ifelse(TF=='PurR', spacing-1.5, spacing), #adjust to center of operator binding sites
spacing = ifelse(TF=='GplR', spacing-3, spacing)) %>% #adjust spacing to center of operator binding site
ggplot(aes(spacing, relative_distal, color = TF)) +
geom_point(alpha = .3) +
geom_line(alpha=.3) +
facet_grid(~TF) +
geom_rect(data=in_phase, aes(x=NULL, y=NULL,xmin=x1, xmax=x2, ymin=y1, ymax=y2, color = NULL), fill='gray60', alpha=0.3) +
geom_smooth(span=.5, se = FALSE, size = 1, alpha = 2.5) +
scale_color_manual(values = pal) +
#geom_vline(xintercept = c(100,110,120), linetype='dotted') +
geom_hline(yintercept=1, linetype = 'dashed', color = 'red') +
scale_x_reverse() +
#ylim(.6,1.25) +
labs(title = 'Expression with only Distal Site', y = 'Relative Expression', x = 'Distance between operators (bp)') +
theme(axis.text.x = element_text(size = 20, angle = 45, hjust = 1),
axis.title.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.text=element_text(size=20),
legend.position = 'none',
strip.text.x = element_text(size = 16),
strip.background = element_blank())
ggsave('../Figure1/Figure1F.pdf', units = 'in', width = 12, height = 4)
#Normalize by dividing distal by nulldistal
in_phase=data.frame(x1=c(102.5,114,125.5), x2=c(105.5,117,128.5), y1=c(.6,.6,.6), y2=c(1.25,1.25,1.25))
nulldistal_exp <- filter(TF_spacing,Distal == 'nulldistal', Background == 'ind')[c(12,14,6)] %>%
mutate(nulldistal_exp=RNA_exp_12) %>%
select(-RNA_exp_12)
TF_spacing %>% filter(., Proximal == 'proximal', Background == 'ind', Distal == 'distal') %>%
mutate(Phase = Offset/11,
spacing=Offset+94) %>% #interoperator distance calculated by: promoter is 71 bp + 23bp TF site + offset
mutate(spacing = ifelse(TF=='GalR', spacing+1, spacing), #adjust to center of operator binding sites
spacing = ifelse(TF=='PurR', spacing-1.5, spacing), #adjust to center of operator binding sites
spacing = ifelse(TF=='GplR', spacing-3, spacing)) %>% #adjust spacing to center of operator binding site
left_join(nulldistal_exp, by = c('TF' , 'Offset')) %>%
group_by(TF, Offset) %>% mutate(RNA_exp_12_norm = RNA_exp_12/nulldistal_exp) %>%
ggplot(aes(spacing, RNA_exp_12_norm, color = TF)) +
geom_point(alpha = .3) +
geom_line(alpha=.3) +
facet_grid(~TF) +
geom_rect(data=in_phase, aes(x=NULL, y=NULL,xmin=x1, xmax=x2, ymin=y1, ymax=y2, color = NULL), fill='gray60', alpha=0.3) +
geom_smooth(span=.5, se = FALSE, size = 1, alpha = 2.5) +
scale_color_manual(values = pal)+
#  geom_vline(xintercept = c(100,110,120), linetype='dotted') +
geom_hline(yintercept = 1, color = 'red', linetype = 'dashed') +
scale_x_reverse() +
ylim(.6,1.25) + #this excludes two points, glpR at offset25 and lldr @offset13
labs(title = 'Expression Normalized by Null Sequence', y = 'Relative expression', x = 'Distance between operators (bp)') +
theme(axis.text.x = element_text(size = 20, angle = 45, hjust = 1),
axis.title.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.text=element_text(size=20),
legend.position = 'none',
strip.text.x = element_text(size = 16),
strip.background = element_blank())
ggsave('../Figure1/Figure1G.pdf', units = 'in', width = 12, height = 4)
