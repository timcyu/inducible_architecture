labs(x = 'Library', y = expression('log'[2]~'(Expression)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24)) +
facet_wrap(~Condition, scales = 'fixed')
# Fold changes
fc <- bind_rows(temp_combo, temp_dist)
fc <- fc %>%
mutate(Prox.Core = coalesce(Proximal, Core)) %>%
select(Library, Prox.Core, Distal, Min_10, Min_35, ratio)
b <- ggplot(fc, aes(x = Library, y = log2(ratio))) +
geom_jitter(aes(fill = Library), size = 2, alpha = 0.95, pch = 21, color = 'black') +
geom_boxplot(outlier.shape = NA, aes(fill = Library), alpha = 0.4) +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 4.5, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("#EE2524","#EBCC2A")) +
scale_fill_manual(values = c("#EE2524","#EBCC2A")) +
labs(x = 'Library', y = expression('log'[2]~'(Fold-change)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24))
plot_grid(a,b, ncol=2)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B.pdf', height = 6, width = 12)
rm(backup, barcode_stats, mapped_barcodes, temp, var)
rm(fLP3_loop)
rm(Compare_barcode_Reps)
rm(barcode_stats_loop)
rm(h1, c1a, c1b, h2, c2a, c2b, h3, c3a, c3b, h4, c4a, c4b)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 5, width = 15)
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =0.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 5, width = 15)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 7, width = 13)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 17)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4A.pdf', width = 10, height = 8)
# FIGURE 4A: PMultiple/Pcombo comparison to show effect of additional distal site on fold-change
colnames(induce_combo)[colnames(induce_combo) == "Distal"] <- "Distal_right"
combo_multiple_comp <- left_join(induce_combo, induce_multiple, by = c("Distal_right", 'Min_10', "Min_35", "Proximal"))
combo_multiple_comp <- combo_multiple_comp[complete.cases(combo_multiple_comp), ] %>% filter(Min_10 == 'minus10cons' & Min_35 == 'minus35cons') # remove NA ones
combo_multiple_comp %>%
filter(Proximal == 'lacOsym' | Proximal == 'lacO1') %>%
group_by(Distal_left, Distal_right) %>%
dplyr::mutate(mean_diff = mean(ratio.y/ratio.x)) %>%
ungroup() %>%
ggplot(., aes(x = Distal_right, y = Distal_left)) + geom_tile(aes(fill = mean_diff), color = 'black', size = 0.5, alpha = 1) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 15), axis.text.y = element_text(size = 15)) +
#scale_fill_distiller(palette = 'PuRd', na.value = 'gray20', name = 'Change in Fold-change') +
scale_fill_viridis(option = 'viridis') +
#scale_fill_gradient2(low = "yellow", mid = "black", high = "purple", midpoint = 0) +
scale_x_discrete(limits = c("lacOscram", "lacO3", 'lacO2', 'lacO1', 'lacOsym')) + scale_y_discrete(limits = c("lacOscram", "lacO3", 'lacO2', 'lacO1', 'lacOsym')) + labs(x = 'Canonical Distal', y = 'Additional Distal', size = 20) +
geom_text(aes(label=signif(mean_diff, 3)), size=5) +
theme(axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24),
legend.text = element_text(size = 20))
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4A.pdf', width = 10, height = 8)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4A.pdf', width = 10, height = 7)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4A.pdf', width = 10, height = 7.5)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4A.pdf', width = 10, height = 8)
# color palettes
libraries <- c('plum', '#19243F', '#EDB83D', '#D70026')
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =0.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 17)
test %>%
ggplot(aes(x=Library, y=log2(Expression))) +
geom_jitter(aes(fill = Library), size = 2, alpha = 0.95, pch = 21, color = 'black') +
geom_boxplot(outlier.shape=NA, aes(fill=Library), alpha = 0.4) +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 8.3, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#19243F")) +
scale_fill_manual(values = c("plum","#19243F")) +
labs(x = 'Library', y = expression('log'[2]~'(Expression)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24)) +
facet_wrap(~Condition, scales = 'fixed')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B1.pdf', height = 5, width = 7)
test %>%
ggplot(aes(x=Library, y=log2(Expression))) +
geom_jitter(aes(fill = Library), size = 2, alpha = 0.95, pch = 21, color = 'black') +
geom_boxplot(outlier.shape=NA, aes(fill=Library), alpha = 0.4) +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 8.3, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#483d8b")) +
scale_fill_manual(values = c("plum","#483d8b")) +
labs(x = 'Library', y = expression('log'[2]~'(Expression)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24)) +
facet_wrap(~Condition, scales = 'fixed')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B1.pdf', height = 5, width = 7)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B1.pdf', height = 5, width = 6)
# Fold changes
fc <- bind_rows(temp_combo, temp_dist)
fc <- fc %>%
mutate(Prox.Core = coalesce(Proximal, Core)) %>%
select(Library, Prox.Core, Distal, Min_10, Min_35, ratio)
b <- ggplot(fc, aes(x = Library, y = log2(ratio))) +
geom_jitter(aes(fill = Library), size = 2, alpha = 0.95, pch = 21, color = 'black') +
geom_boxplot(outlier.shape = NA, aes(fill = Library), alpha = 0.4) +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 4.5, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#483d8b")) +
scale_fill_manual(values = c("plum","#483d8b")) +
labs(x = 'Library', y = expression('log'[2]~'(Fold-change)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24))
plot_grid(a,b, ncol=2)
plot_grid(a,b, ncol=2)
b <- ggplot(fc, aes(x = Library, y = log2(ratio))) +
geom_jitter(aes(fill = Library), size = 2, alpha = 0.95, pch = 21, color = 'black') +
geom_boxplot(outlier.shape = NA, aes(fill = Library), alpha = 0.4) +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 4.5, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#483d8b")) +
scale_fill_manual(values = c("plum","#483d8b")) +
labs(x = 'Library', y = expression('log'[2]~'(Fold-change)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size =
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B2.pdf', height = 5, width = 3)
ggplot(fc, aes(x = Library, y = log2(ratio))) +
ggplot(fc, aes(x = Library, y = log2(ratio))) +
geom_jitter(aes(fill = Library), size = 2, alpha = 0.95, pch = 21, color = 'black') +
geom_boxplot(outlier.shape = NA, aes(fill = Library), alpha = 0.4) +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 4.5, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#483d8b")) +
scale_fill_manual(values = c("plum","#483d8b")) +
labs(x = 'Library', y = expression('log'[2]~'(Fold-change)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24))
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B2.pdf', height = 5, width = 3)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B2.pdf', height = 5, width = 4)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B2.pdf', height = 5, width = 3.5)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 0.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 24)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
labs(x = 'Variant')
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 2) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 24)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 25)
# FIGURE 4A: PMultiple/Pcombo comparison to show effect of additional distal site on fold-change
colnames(induce_combo)[colnames(induce_combo) == "Distal"] <- "Distal_right"
combo_multiple_comp <- left_join(induce_combo, induce_multiple, by = c("Distal_right", 'Min_10', "Min_35", "Proximal"))
combo_multiple_comp <- combo_multiple_comp[complete.cases(combo_multiple_comp), ] %>% filter(Min_10 == 'minus10cons' & Min_35 == 'minus35cons') # remove NA ones
combo_multiple_comp %>%
filter(Proximal == 'lacOsym' | Proximal == 'lacO1') %>%
group_by(Distal_left, Distal_right) %>%
dplyr::mutate(mean_diff = mean(ratio.y/ratio.x)) %>%
ungroup() %>%
ggplot(., aes(x = Distal_right, y = Distal_left)) + geom_tile(aes(fill = mean_diff), color = 'black', size = 0.25, alpha = 1) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 15), axis.text.y = element_text(size = 15)) +
#scale_fill_distiller(palette = 'PuRd', na.value = 'gray20', name = 'Change in Fold-change') +
scale_fill_viridis(option = 'viridis') +
#scale_fill_gradient2(low = "yellow", mid = "black", high = "purple", midpoint = 0) +
scale_x_discrete(limits = c("lacOscram", "lacO3", 'lacO2', 'lacO1', 'lacOsym')) + scale_y_discrete(limits = c("lacOscram", "lacO3", 'lacO2', 'lacO1', 'lacOsym')) + labs(x = 'Canonical Distal', y = 'Additional Distal', size = 20) +
geom_text(aes(label=signif(mean_diff, 3)), size=5) +
theme(axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24),
legend.text = element_text(size = 20))
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4A.pdf', width = 10, height = 8)
test %>%
ggplot(aes(x=Library, y=log2(Expression))) +
geom_boxplot(outlier.shape=NA, aes(fill=Library), alpha = 0.4) +
geom_jitter(aes(fill = Library), size = 2, alpha = 1, pch = 21, color = 'black') +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 8.3, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#483d8b")) +
scale_fill_manual(values = c("plum","#483d8b")) +
labs(x = 'Library', y = expression('log'[2]~'(Expression)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24)) +
facet_wrap(~Condition, scales = 'fixed')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B1.pdf', height = 5, width = 6)
# Fold changes
fc <- bind_rows(temp_combo, temp_dist)
fc <- fc %>%
mutate(Prox.Core = coalesce(Proximal, Core)) %>%
select(Library, Prox.Core, Distal, Min_10, Min_35, ratio)
ggplot(fc, aes(x = Library, y = log2(ratio))) +
geom_boxplot(outlier.shape = NA, aes(fill = Library), alpha = 0.4) +
geom_jitter(aes(fill = Library), size = 2, alpha = 1, pch = 21, color = 'black') +
geom_signif(comparisons = list(c("COMBO", "DISTAL")),
y_position= 4.5, map_signif_level= function(p)sprintf("p = %.2g", p), test="wilcox.test") +
scale_color_manual(values = c("plum","#483d8b")) +
scale_fill_manual(values = c("plum","#483d8b")) +
labs(x = 'Library', y = expression('log'[2]~'(Fold-change)')) +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24))
ggsave('~/Desktop/InducibleArchitectures/Figure4/Fig_4B2.pdf', height = 5, width = 3.5)
steric_box %>%
filter(Proximal == 'lacO1', Core == 'lacO1') %>%
ggplot(., aes(fill = Min_10, y = ratio, x = category)) +
geom_bar(position = 'dodge', stat = 'identity', alpha = 1, color = 'black') + scale_x_discrete(limits = c('no_up_ext_UV5', 'up_326x_ext_UV5', 'no_up_ext_10', 'up_326x_ext_10')) +   scale_fill_viridis() + labs(y = 'Fold-change', x = 'Regulatory element combination') + theme(axis.text.x = element_text(angle = 45, hjust = 1, size =10)) +
theme(axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24),
legend.text = element_text(size = 15))
steric_box %>%
filter(Proximal == 'lacO1', Core == 'lacO1') %>%
ggplot(., aes(fill = Min_10, y = ratio, x = category)) +
geom_bar(position = 'dodge', stat = 'identity', alpha = 1, color = 'black') + scale_x_discrete(limits = c('no_up_ext_UV5', 'up_326x_ext_UV5', 'no_up_ext_10', 'up_326x_ext_10')) +   scale_fill_viridis(discrete = TRUE) + labs(y = 'Fold-change', x = 'Regulatory element combination') + theme(axis.text.x = element_text(angle = 45, hjust = 1, size =10)) +
theme(axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
title = element_text(size = 24),
legend.text = element_text(size = 15))
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4C.pdf', width = 10, height = 7)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4C.pdf', width = 7, height = 5)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4C.pdf', width = 7, height = 4)
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4C.pdf', width = 7, height = 5)
maxCombo <- top_n(induce_combo$normalized_RNA_exp_Induced_12)
maxCombo <- top_n(induce_combo$normalized_RNA_exp_Induced_12, 1)
?top_n()
maxCombo <- top_n(induce_combo, 1, wt=normalized_RNA_exp_Induced_12)
View(maxCombo)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
# color palettes
libraries <- c('plum', '#888fc6', '#EDB83D', '#D70026')
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "orange")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed') +
geom_hline(yintercept = maxDistal, color = '#888fc6', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
#ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 25)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("grey", "skyblue")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed') +
geom_hline(yintercept = maxDistal, color = '#888fc6', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed') +
geom_hline(yintercept = maxDistal, color = '#888fc6', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
# color palettes
libraries <- c('plum', '#40568f', '#EDB83D', '#D70026')
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.25, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed') +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
#ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 25)
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =2.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 1.5) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed') +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =2.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed') +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =2.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed') +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed') +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed') +
labs(x = 'Variant')
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =2.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1.5) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed', size = 1.5) +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed', size = 1.5) +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed', size = 1.5) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 25)
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =2, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1.5) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed', size = 1.5) +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed', size = 1.5) +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed', size = 1.5) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 26)
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =2, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed', size = 1.5, alpha = 0.8) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 26)
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed', size = 1.5, alpha = 0.8) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 26)
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1.5, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 3) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed', size = 1.5, alpha = 0.8) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 23)
# Figure 4D
top10combo <- induce_combo %>% top_frac(0.05, wt = ratio)
top10distal <- induce_distal %>% top_frac(0.05, wt = ratio)
top10multiple <- induce_multiple %>% top_frac(0.05, wt = ratio)
top10steric <- induce_steric %>% top_frac(0.05, wt = ratio)
inducible <- bind_rows(top10combo, top10distal, top10multiple, top10steric)
maxCombo <- top_n(top10combo, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxDistal <- top_n(top10distal, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxMultiple <- top_n(top10multiple, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
maxSteric <- top_n(top10steric, 1, wt=normalized_RNA_exp_Induced_12)$normalized_RNA_exp_Induced_12
inducible %>%
mutate(orderExp = normalized_RNA_exp_UnInduced_12) %>%
gather(Type, Expression, 'normalized_RNA_exp_Induced_12':'normalized_RNA_exp_UnInduced_12') %>%
ggplot(aes(x = reorder(name, orderExp), y = Expression)) + geom_line(aes(color = Library), size =1, alpha = 1) + geom_point(aes(fill = Type), pch = 21, color = 'black', size = 2.25) + theme(axis.text.x = element_blank()) +
scale_color_manual(values = libraries) +
scale_fill_manual(values = c("skyblue", "grey")) +
geom_hline(yintercept = maxCombo, color = 'plum', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxDistal, color = '#40568f', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxMultiple, color = '#EDB83D', linetype = 'dashed', size = 1.5, alpha = 0.8) +
geom_hline(yintercept = maxSteric, color = '#D70026', linetype = 'dashed', size = 1.5, alpha = 0.8) +
labs(x = 'Variant')
ggsave('~/Desktop/InducibleArchitectures/Figure4/Figure4D.pdf', height = 4, width = 20)
